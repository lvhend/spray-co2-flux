# spray-co2-flux-2025
MATLAB code to model air-sea CO2 flux driven by sea spray

This repository contains a model for air-sea CO2 exchange driven by sea spray evaporation, hereafter referred to as SAGE. The SAGE model calculates the changes in carbonate chemistry and CO2 gas exchange within a spray droplet driven by its temperature changes and evaporation. The individual droplet results are scaled by the full spray production modeled using the sea spray generation equations of Barr et al (2023) (B23) and Andreas (1998) (A98). 
SAGE builds on the microphysics of sea spray evaporation modeled by the late Edgar Andreas (https://people.nwra.com/resumes/andreas/software.php), and uses CO2SYS to model carbon chemistry. The CO2SYS file here was downloaded in 2023 from Jonathan Sharp (https://github.com/jonathansharp/CO2-System-Extd) and modified by adding carbon equilibrium constants for hypersaline conditions determined by Papadimitriou et al (2018). These constants better account for the conditions of droplets that reach near or total evaporation. Sea spray generation is modeled using the equations of Barr et al (2023) and Andreas (1998). 
There are two versions of SAGE, one that treats CO2 as a nonreactive gas, and one that incorporates carbonate chemistry using CO2SYS. There is also a reference calculation that estimates the upper limit of spray-driven CO2 flux by assuming all dissolved inorganic carbon (DIC) within sea spray converts to CO2 and evades. The SAGE model and its comparison versions originate from Hendrickson et al (submitted). 
This model relies on the data output of the WaveWatch3 model (WW3) as published in Romero (2019). An example dataset has been included to show how the WW3 data must be structured for the SAGE model to run. A user should download both the files and the WW3 example data. SAGE (with or without carbonate chemistry) is run using the respective SAGE_Runs file stored in the named folder. For both SAGE versions, the postprocessing file will perform a preliminary sorting and graphing of the results. 
Any questions should be emailed to lucy.hendrickson@uconn.edu.

# Individual Spray Drops: CO2 Chemistry and Gas Flux
CO2 is reactive, and its concentration is affected by the chemistry of other dissolved carbon species. The Andreas spray microphysical model computes temperature (T) and salinity (S) evolutions over time for a single spray droplet. At each timestep, the Henry's constant (KH) for CO2 in seawater is calculated using the temperature and salinity at that point in the droplet's evolution. CO2SYS is used to compute the distribution of carbonate species in the droplet as the temperature and salinity evolve, and the gas exchange at each timestep is calculated using the droplet's partial pressure of CO2 and the KH for that point. This approach accounts for the conversion of DIC into CO2 or vice versa as internal droplet conditions change. The droplet's CO2 flux at each timestep is integrated over to yield a net CO2 flux for spray droplet of a given size. This integration is performed twice, once over a spray lifetime aloft as calculated based on wind speed alone, and separately taking the sea state into account using wave data from WW3. 
Most CO2 flux models treat CO2 as a nonreactive gas. A separate version of SAGE that treats CO2 as a nonreactive gas is included to quantify the effect of carbonate chemistry on spray-driven CO2 flux. In this version, the Henry's constant (KH) for CO2 in seawater is calculated using the temperature and salinity at each timestep as before. The Weiss (1982) temperature and salinity dependent equations for the fugacity of CO2 in seawater are used to calculate the concentration of CO2 in the droplet at each timestep. The droplet's gas flux over time is calculated as in the chemically-comprehensive version. 

# Sea Spray Generation Functions: Wind and Sea State Parameterizations
Within the SAGE model, two sea spray generation functions (SSGFs) are used to estimate spray production, a novel one that incorporates sea state parameters (B23) and earlier one that relies solely on the wind speed (A98) for reference. The B23 function was modified to incorporate WW3 data outputs. 

# Net CO2 Flux Upper Limits 
The upper limit to spray-driven carbon flux is calculated separately to add context. CO2SYS is used to generate a full carbonate system profile of the surface water from a set of initial DIC, salinity, pH and temperature values. Assuming total conversion of carbonate and bicarbonate to CO2, and total evasion of CO2, the upper limit of CO2 production per liter of seawater is calculated. Using the SSGFs for droplet size distribution and total spray volume production, the upper limit of carbon efflux per liter of seawater is converted to the upper limit of carbon efflux due to sea spray. 

# SAGE: Net CO2 Flux from All Spray Produced
The SAGE_Run files first call the carbonate chemistry and gas flux functions described above to compute the contribution of each droplet size class on net air-sea kinematic CO2 flux in a wind-only or  sea state inclusive scenario. Then they call the SSGFs to compute the number of droplets lifted of each size class. Finally, the individual droplet CO2 flux results are then scaled by the number of each droplet produced under the specified conditions, and integrated to give two spray-driven net fluxes, one that relies on wind-only parameterizations, and one that includes the sea state as modeled by WW3. 

# Wave Data 
Wave data provided are for example purposes only and may not represent realistic conditions, especially at very young and very old wave ages. The data were generated using WaveWatch3 as described in Romero (2019). 

# References
Andreas, E. L. (1998). A New Sea Spray Generation Function for Wind Speeds up to 32 m s−1. https://journals.ametsoc.org/view/journals/phoc/28/11/1520-0485_1998_028_2175_anssgf_2.0.co_2.xml
Andreas, E. L. (2013). An Algorithm for Fast Microphysical Calculations that Predict the Evolution of Saline Droplets [Computer software]. NWRA. www.nwra.com/resumes/andreas/ software.php
Andreas, E. L., Vlahos, P., & Monahan, E. C. (2017). Spray-Mediated Air-Sea Gas Exchange: The Governing Time Scales. Journal of Marine Science and Engineering, 5(4), 60.
Angle, K. J., Crocker, D. R., Simpson, R. M. C., Mayer, K. J., Garofalo, L. A., Moore, A. N., Mora Garcia, S. L., Or, V. W., Srinivasan, S., Farhan, M., Sauer, J. S., Lee, C., Pothier, M. A., Farmer, D. K., Martz, T. R., Bertram, T. H., Cappa, C. D., Prather, K. A., & Grassian, V. H. (2021). Acidity across the interface from the ocean surface to sea spray aerosol. Proceedings of the National Academy of Sciences, 118(2), e2018397118. https://doi.org/10.1073/pnas.2018397118
Barr, B. W., Chen, S. S., & Fairall, C. W. (2023). Sea-State-Dependent Sea Spray and Air–Sea Heat Fluxes in Tropical Cyclones: A New Parameterization for Fully Coupled Atmosphere–Wave–Ocean Models. Journal of the Atmospheric Sciences, 80(4), 933–960. https://doi.org/10.1175/JAS-D-22-0126.1
Papadimitriou, S., Loucaides, S., Rérolle, V. M. C., Kennedy, P., Achterberg, E. P., Dickson, A. G., Mowlem, M., & Kennedy, H. (2018). The stoichiometric dissociation constants of carbonic acid in seawater brines from 298 to 267 K. Geochimica et Cosmochimica Acta, 220, 55–70. https://doi.org/10.1016/j.gca.2017.09.037
Romero, L. (2019). Distribution of Surface Wave Breaking Fronts. Geophysical Research Letters, 46(17–18), 10463–10474. https://doi.org/10.1029/2019GL083408
Sharp, J. D. et al. (2023). CO2SYSv3 for MATLAB (Version 3) [MATLAB]. https://www.mathworks.com/matlabcentral/fileexchange/78378-co2sysv3-for-matlab
Weiss, R. F. (1974). Carbon dioxide in water and seawater: The solubility of a non-ideal gas. Marine Chemistry, 2(3), 203–215. https://doi.org/10.1016/0304-4203(74)90015-2
Weiss, R. F., Jahnke, R. A., & Keeling, C. D. (1982). Seasonal effects of temperature and salinity on the partial pressure of CO2 in seawater. Nature, 300(5892), 511–513. https://doi.org/10.1038/300511a0
